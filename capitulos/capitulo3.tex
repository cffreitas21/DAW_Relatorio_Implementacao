\chapter{Desenho do Sistema}
\label{cap3}

Neste capitulo é apresentada a descrição do modelo de base de dados que irá suportar o sistema. 
Primeiro, é exposto o modelo Entidade/Relação com todas as entidades e a relação entre elas. 
Em seguida, é apresentado o modelo lógico relacional da base de dados, com a estrutura normalizada composta pelas tabelas, 
chaves primárias e estrangeiras e o tipo de dados associados a cada atributo.

Na segunda parte deste capítulo, são expostas as interfaces graficas de média fidelidade associadas a cada caso de uso bem como um 
storyboard de baixa fidelidade que ajudará a compreender, numa primeira fase, o funcionamento da aplicação.

\clearpage
\section{Modelação da Base de Dados}

\subsection{Diagrama de Entidade Relação}

No seguinte diagrama de Entidade/Relação conseguem-se observar as entidades associadas aos utilizadores(atores),
as entidade relacionadas com os filmes e os respetivos comentários. Podemos observar também que os utilizadores
geram dados de utilização da aplicação, onde iremos conseguir observar o comportamento de cada utilizador ao longo 
das sessões.


\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\textwidth]{figuras/Base de Dados/ER_Conceitual.png}
    \caption{Diagrama de Entidade Relação}
    \label{fig:ER}
\end{figure}

\begin{table}[H]
    \begin{tabular}{|l|c|p{5cm}|}
        \hline
        \textbf{Relação} & \textbf{Tipo} & \textbf{Descrição} \\
        \hline
        utilizador (1) — comentario (N) & 1:N & Um utilizador pode escrever vários comentários. \\
        \hline
        filme (1) — comentario (N) & 1:N & Um filme pode ter vários comentários. \\
        \hline
        utilizador (1) — analiseUtilizacao (N) & 1:N & Um utilizador pode gerar múltiplos dados de utilização. \\
        \hline
    \end{tabular}
    \centering
    \caption{Relações do Diagrama Entidade-Relação}
    \label{tab:relacoes_entidades}
\end{table}


\subsection{Modelo Lógico Relacional}
No seguinte modelo lógico relacional é possível verificar as tabelas da base de dados, os respetivos atributos e respetivos tipos de dados 
bem como a chave primária de cada tabela.

De seguida, são também apresentadas tabelas com toda a lógica, incluindo as chaves estrangeiras associadas a cada tabela.

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{figuras/Base de Dados/ER_Lógico.png}
    \caption{Modelo Lógico Relacional}
    \label{fig:MLR}
\end{figure}


\begin{table}[H]
    \begin{tabular}{|l|c|p{5cm}|}
        \hline
        \textbf{Campo} & \textbf{Tipo de Dados} & \textbf{Restrições} \\
        \hline
        id\_utilizador & INT & PRIMARY KEY, AUTO\_INCREMENT \\
        \hline
        nome & VARCHAR(100) & NOT NULL \\
        \hline
        email & VARCHAR(100) & UNIQUE, NOT NULL \\
        \hline
        password & VARCHAR(255) & NOT NULL \\
        \hline
        tipo\_utilizador & ENUM('cinefilo', 'administrador') & NOT NULL \\
        \hline
    \end{tabular}
    \centering
    \caption{Estrutura da Tabela de Utilizador}
    \label{tab:tabela_utilizador}
\end{table}

\begin{table}[H]
    \begin{tabular}{|l|c|p{5cm}|}
        \hline
        \textbf{Campo} & \textbf{Tipo de Dados} & \textbf{Restrições} \\
        \hline
        id\_filme & INT & PRIMARY KEY, AUTO\_INCREMENT \\
        \hline
        titulo & VARCHAR(150) & NOT NULL \\
        \hline
        imagem\_capa & VARCHAR(255) & NULL \\
        \hline
        ano\_lancamento & INT & NOT NULL \\
        \hline
        idioma & VARCHAR(50) & NOT NULL \\
        \hline
        genero & VARCHAR(50) & NOT NULL \\
        \hline
        rating & DOUBLE & NOT NULL \\
        \hline
        sinopse & TEXT & NOT NULL \\
        \hline
    \end{tabular}
    \centering
    \caption{Estrutura da Tabela de Filme}
    \label{tab:tabela_filme}
\end{table}

\begin{table}[H]
    \begin{tabular}{|l|c|p{5cm}|}
        \hline
        \textbf{Campo} & \textbf{Tipo de Dados} & \textbf{Restrições} \\
        \hline
        id\_comentario & INT & PRIMARY KEY, AUTO\_INCREMENT \\
        \hline
        id\_utilizador & INT & FOREIGN KEY → Utilizador(id\_utilizador) \\
        \hline
        id\_filme & INT & FOREIGN KEY → Filme(id\_filme) \\
        \hline
        texto & TEXT & NOT NULL \\
        \hline
        data\_comentario & DATETIME & DEFAULT CURRENT\_TIMESTAMP \\
        \hline
        estado & ENUM('pendente', 'aprovado', 'rejeitado') & DEFAULT 'pendente' \\
        \hline
    \end{tabular}
    \centering
    \caption{Estrutura da Tabela de Comentário}
    \label{tab:tabela_comentario}
\end{table}

\begin{table}[H]
    \begin{tabular}{|l|c|p{5cm}|}
        \hline
        \textbf{Campo} & \textbf{Tipo de Dados} & \textbf{Restrições} \\
        \hline
        id\_analise & INT & PRIMARY KEY, AUTO\_INCREMENT \\
        \hline
        id\_utilizador & INT & FOREIGN KEY → Utilizador(id\_utilizador) \\
        \hline
        numero\_sessoes & INT & NOT NULL DEFAULT 0 \\
        \hline
        tempo\_sessao & INT & NOT NULL DEFAULT 0 \\
        \hline
        cliques & INT & NOT NULL DEFAULT 0 \\
        \hline
        pesquisas & INT & NOT NULL DEFAULT 0 \\
        \hline
        comentarios\_sessao & INT & NOT NULL DEFAULT 0 \\
        \hline
        comentarios\_total & INT & NOT NULL DEFAULT 0 \\
        \hline
        data\_registo & DATETIME& NOT NULL DEFAULT CURRENT\_TIMESTAMP \\
        \hline
    \end{tabular}
    \centering
    \caption{Estrutura da Tabela de Dados de Utilização}
    \label{tab:tabela_dados}
\end{table}



\section{Modelação de Interfaces Gráficas com o utilizador}

\subsection{StoryBoards}
\subsection{Interfaces do caso de uso ``1''}
\subsection{Interfaces do caso de uso ``2''}
\subsection{Interfaces do caso de uso ``3''}


